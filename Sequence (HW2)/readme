See sequence.h for details
